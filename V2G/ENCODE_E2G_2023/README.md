## ENCODE Enhancer-Gene GWAS benchmark analysis ##

We provide here a pipeline for running the GWAS benchmark results for enhancer-gene or peak-gene linking strategies from ENCODE, IGVF etc.

#################### Finemap enrichment analysis ####################################

**Primary_CRE_gene_linkfiles_ENCODE_E2G_2024.R**: This code has internal functions to read in thresholded predictions from a variety of enhancer-gene maps. This script is sourced to load the internal functions by build_module_annotations_2024.R

**build_module_annotations_2024.R**: Script called in to generate bed/bedgraph files corresponding to thresholded enhancer-gene predictions. The command line to run this code is build_module_annotations_2024.sh

**clean_bedgraphs.sh**: Some of the bed regions generated by the above script may have overlapping regions, which are merged into one by this code.

**create_annot_from_bedgraph.sh**: Generate variant-level annotations correspobding to the bed files of enhancer-gene maps for 10 million common and low-freq variants. This script runs internally the Python script make_annot_combine_from_bedgraph.py. 

**overlap_finemap_GM12878_ulirsch.R**: Fine-mapped variant enrichment and recall for WBC biomarker traits for GM12878 specific enhancer-gene maps. The fine-mapped variant ID list is in the folder **Other_finemapped**. 

**overlap_finemap_K562_ulirsch.R**: Fine-mapped variant enrichment and recall for WBC biomarker traits for K562 specific enhancer-gene maps. The fine-mapped variant ID	   list is in the folder **Other_finemapped**.


###################  PoPS silver-standard GWAS variant-gene links #############################

**create_EG_predictions.R** : Create enhancer-gene scored maps aggregated across all biosamples and blood biosamples for each assay

**run_benchmark_popsmetric_eg.R** : This code runs the precision and recall for silver-standard GWAS credible set to gene maps for enhancer-gene, PoPS scored genes and PoPS x enhancer-gene maps. This code takes internally the code benchmark_EG_finemapUKBB_gene_NUMEG.R script. The command line to run this is through run_benchmark_popsmetric_eg.sh.The PoPS benchmarking data is in UKBiobank.ABCGene.anyabc.tsv file saved in the folder. 

 


